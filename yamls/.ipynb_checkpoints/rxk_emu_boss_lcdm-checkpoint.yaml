# Sample Yaml File for the Full BOSS Analysis
# To run in your directory, subsitute the basedir where the BOSSxPlanck repo is kept
# e.g. in my case its path is /global/cscratch1/sd/sfschen/BOSSxPlanck/BOSSxPlanck

theory:
  joint_likelihood_gc_emu_lnA.Taylor_pk_theory_zs:
      zfids:
      - 0.61
      - 0.38
      pk_filenames:
      - BOSSxPlanck/emulator/emu/boss_z_0.61_pkells.json
      - BOSSxPlanck/emulator/emu/boss_z_0.38_pkells.json
      xi_filenames:
      - BOSSxPlanck/emulator/emu/boss_z_0.61_xiells.json
      - BOSSxPlanck/emulator/emu/boss_z_0.38_xiells.json
      s8_filename: BOSSxPlanck/emulator/emu/boss_s8.json
      basedir: /global/cscratch1/sd/sfschen/BOSSxPlanck/
      
      stop_at_error: True
      
likelihood:
  joint_boss_likelihoods_emu_lnA.FullShapePlusBAOEmu_Z3:
    basedir: /global/cscratch1/sd/sfschen/BOSSxPlanck/
    fs_kmins:
    - 0.02
    - 0.02
    fs_mmaxs:
    - 0.20
    - 0.20
    fs_qmaxs:
    - 0.20
    - 0.20
    bao_rmins:
    - 80.
    bao_rmaxs:
    - 130.
    stop_at_error: True
    
  joint_boss_likelihoods_emu_lnA.FullShapePlusBAOEmu_Z1:
    basedir: /global/cscratch1/sd/sfschen/BOSSxPlanck/
    fs_kmins:
    - 0.02
    - 0.02
    fs_mmaxs:
    - 0.20
    - 0.20
    fs_qmaxs:
    - 0.20
    - 0.20
    bao_rmins:
    - 80.
    bao_rmaxs:
    - 130.
    stop_at_error: True

  gxk_emu_lik.GxKLikelihood:
    model:  clpt
    basedir: /global/cscratch1/sd/sfschen/BOSSxPlanck/
    clsfn:  BOSSxPlanck/data/gal_zall_cls.txt
    covfn:  BOSSxPlanck/data/gal_zall_cov.txt
    Emufn:
         - BOSSxPlanck/emulator/emu/ckg_NGCz1.json
         - BOSSxPlanck/emulator/emu/ckg_NGCz3.json
         - BOSSxPlanck/emulator/emu/ckg_SGCz1.json
         - BOSSxPlanck/emulator/emu/ckg_SGCz3.json
    zeff:
         -  0.38
         -  0.61
         -  0.38
         -  0.61
    suffx:
         -  NGCz1
         -  NGCz3
         -  SGCz1
         -  SGCz3
    wlafn:
         -  BOSSxPlanck/data/gal_s11_wla.txt
         -  BOSSxPlanck/data/gal_s13_wla.txt    
         -  BOSSxPlanck/data/gal_s21_wla.txt
         -  BOSSxPlanck/data/gal_s23_wla.txt
    wlxfn:
         -  BOSSxPlanck/data/gal_s11_wlx.txt
         -  BOSSxPlanck/data/gal_s13_wlx.txt    
         -  BOSSxPlanck/data/gal_s21_wlx.txt
         -  BOSSxPlanck/data/gal_s23_wlx.txt
    acut:
        -   0
        -   0    
        -   0
        -   0
    xcut:
        -   250
        -   350    
        -   250
        -   350
    stop_at_error: True

params:
  H0:
    prior:
      min: 60.0
      max: 80.0
    ref:
      dist: norm
      loc:  69.2267
      scale: 1.0
    latex: H_0
  omegam:
    prior:
      min: 0.2
      max: 0.4
    ref:
      dist: norm
      loc: 0.31114202
      scale: 0.05
    latex: \Omega_\mathrm{m}
  logA:
    prior:
      dist: uniform
      min:  1.61
      max:  3.91
    ref:
      dist:  norm
      loc:   3.00
      scale: 0.05
    latex: \log(10^{10} A_\mathrm{s})
  sigma8:
    latex: \sigma_8
    
  # NGCz3
  bsig8_NGCz3:
    prior:
      dist: uniform
      min:  0.5
      max:  3.0
    ref:
      dist:  norm
      loc:   1.8254628 
      scale: 0.05
    latex: (1+b_1^{N3})\sigma_8
  b2_NGCz3:
    prior:
      dist:  norm
      loc:   0.0
      scale: 10.
    ref:
      dist:  norm
      loc:   -2.8775721
      scale: 0.1
    latex: b_2^{N3}
  bs_NGCz3:
    prior:
      dist:  norm
      loc:   0.0
      scale: 5.0
    ref:
      dist:  norm
      loc:   1.3425739
      scale: 0.1
    latex: b_s^{N3}
  alpha0_NGCz3:
    prior:
      dist:  norm
      loc:   0.0
      scale: 100.
    ref:
      dist:  norm
      loc:   3.6416256
      scale: 0.5
    latex: \alpha_0^{N3}
  alpha2_NGCz3:
    prior:
      dist:  norm
      loc:   0.0
      scale: 100.
    ref:
      dist:  norm
      loc:   18.663294
      scale: 0.5
    latex: \alpha_2^{N3}
  SN0_NGCz3:
    prior:
      dist:  norm
      loc:   0.0
      scale: 1000.
    ref:
      dist:  norm
      loc:   474.25309
      scale: 100.
    latex: SN_0^{N3}
  SN2_NGCz3:
    prior:
      dist:  norm
      loc:   0.0
      scale: 5e4
    ref:
      dist:  norm
      loc:   4248.9989
      scale:  1e3
    latex: SN_2^{N3}

  # SGCz3
  bsig8_SGCz3:
    prior:
      dist: uniform
      min:  0.5
      max:  3.0
    ref:
      dist:  norm
      loc:   1.7090505
      scale: 0.05
    latex: (1+b_1^{S3})\sigma_8
  b2_SGCz3:
    prior:
      dist:  norm
      loc:   0.0
      scale: 10.
    ref:
      dist:  norm
      loc:   0.82613992
      scale: 0.1
    latex: b_2^{S3}
  bs_SGCz3:
    prior:
      dist:  norm
      loc:   0.0
      scale: 5.0
    ref:
      dist:  norm
      loc:   -1.401814
      scale: 0.1
    latex: b_s^{S3}
  alpha0_SGCz3:
    prior:
      dist:  norm
      loc:   0.0
      scale: 100.
    ref:
      dist:  norm
      loc:   -32.849574
      scale: 0.5
    latex: \alpha_0^{S3}
  alpha2_SGCz3:
    prior:
      dist:  norm
      loc:   0.0
      scale: 100.
    ref:
      dist:  norm
      loc:   8.4665742 
      scale: 0.5
    latex: \alpha_2^{S3}
  SN0_SGCz3:
    prior:
      dist:  norm
      loc:   0.0
      scale: 1000.
    ref:
      dist:  norm
      loc:   -407.04845
      scale: 100.
    latex: SN_0^{S3}
  SN2_SGCz3:
    prior:
      dist:  norm
      loc:   0.0
      scale: 5e4
    ref:
      dist:  norm
      loc:  -19243.186
      scale:  1e3
    latex: SN_2^{S3}
  # NGCz1
  bsig8_NGCz1:
    prior:
      dist: uniform
      min:  0.5
      max:  3.0
    ref:
      dist:  norm
      loc:   1.7003233
      scale: 0.05
    latex: (1+b_1^{N1})\sigma_8
  b2_NGCz1:
    prior:
      dist:  norm
      loc:   0.0
      scale: 10.
    ref:
      dist:  norm
      loc:   -1.3032863
      scale: 0.1
    latex: b_2^{N1}
  bs_NGCz1:
    prior:
      dist:  norm
      loc:   0.0
      scale: 5.0
    ref:
      dist:  norm
      loc:   1.1374705
      scale: 0.1
    latex: b_s^{N1}
  alpha0_NGCz1:
    prior:
      dist:  norm
      loc:   0.0
      scale: 100.
    ref:
      dist:  norm
      loc:   33.213286
      scale: 0.5
    latex: \alpha_0^{N1}
  alpha2_NGCz1:
    prior:
      dist:  norm
      loc:   0.0
      scale: 100.
    ref:
      dist:  norm
      loc:   13.272394
      scale: 0.5
    latex: \alpha_2^{N1}
  SN0_NGCz1:
    prior:
      dist:  norm
      loc:   0.0
      scale: 1000.
    ref:
      dist:  norm
      loc:   -452.21022
      scale: 100.
    latex: SN_0^{N1}
  SN2_NGCz1:
    prior:
      dist:  norm
      loc:   0.0
      scale: 5e4
    ref:
      dist:  norm
      loc:   -55805.158
      scale:  1e3
    latex: SN_2^{N1}

  # SGCz1
  bsig8_SGCz1:
    prior:
      dist: uniform
      min:  0.5
      max:  3.0
    ref:
      dist:  norm
      loc:   1.5666217
      scale: 0.05
    latex: (1+b_1^{S1})\sigma_8
  b2_SGCz1:
    prior:
      dist:  norm
      loc:   0.0
      scale: 10.
    ref:
      dist:  norm
      loc:   -0.54533033
      scale: 0.1
    latex: b_2^{S1}
  bs_SGCz1:
    prior:
      dist:  norm
      loc:   0.0
      scale: 5.0
    ref:
      dist:  norm
      loc:   0.7529962
      scale: 0.1
    latex: b_s^{S1}
  alpha0_SGCz1:
    prior:
      dist:  norm
      loc:   0.0
      scale: 100.
    ref:
      dist:  norm
      loc:   3.0103266 
      scale: 0.5
    latex: \alpha_0^{S1}
  alpha2_SGCz1:
    prior:
      dist:  norm
      loc:   0.0
      scale: 100.
    ref:
      dist:  norm
      loc:   2.6020471
      scale: 0.5
    latex: \alpha_2^{S1}
  SN0_SGCz1:
    prior:
      dist:  norm
      loc:   0.0
      scale: 1000.
    ref:
      dist:  norm
      loc:   224.40581
      scale: 100.
    latex: SN_0^{S1}
  SN2_SGCz1:
    prior:
      dist:  norm
      loc:   0.0
      scale: 5e4
    ref:
      dist:  norm
      loc:  -5368.8114
      scale:  1e3
    latex: SN_2^{S1}
  
    
  # Post-recon parameters
  B1_z3:
    prior:
      dist: uniform
      min: 0.0
      max: 5.0
    ref:
      dist: norm
      loc: 1.12
      scale: 0.1
    latex: B_1^{z3}
  F_z3:
    prior:
      dist: uniform
      min: 0.0
      max: 5.0
    ref:
      dist: norm
      loc: 0.63
      scale: 0.1
    latex: F^{z3}
  # For these priors we take the philosophy that rba0^2 (a0 + a1/rbao) <~ <rbao^2 xi> ~ 50
  # i.e. a0 <~ 5e-3, a2 <~ 5e-1, and we enforce a 10x wide Gaussian prior on this estimation
  M0_z3:
    prior:
      dist: norm
      loc: 0.
      scale: 5e-2
    ref:
      dist: norm
      loc: 0.00405758
      scale: 0.001
    latex: M_0^{z3}
  M1_z3:
    prior:
      dist: norm
      loc: 0.
      scale: 5.
    ref:
      dist: norm
      loc: -0.30657935
      scale: 0.1
    latex: M_1^{z3}
  M2_z3:
    value: 0.
  Q0_z3:
    prior:
      dist: norm
      loc: 0.
      scale: 5e-2
    ref:
      dist: norm
      loc: -0.00699841
      scale: 0.001
    latex: Q_0^{z3}
  Q1_z3:
    prior:
      dist: norm
      loc: 0.
      scale: 5.
    ref:
      dist: norm
      loc: 0.93152832
      scale: 0.1
    latex: Q_1^{z3}
  Q2_z3:
    value: 0.

  B1_z1:
    prior:
      dist: uniform
      min: 0.0
      max: 5.0
    ref:
      dist: norm
      loc: 1.12
      scale: 0.1
    latex: B_1^{z1}
  F_z1:
    prior:
      dist: uniform
      min: 0.0
      max: 5.0
    ref:
      dist: norm
      loc: 0.63
      scale: 0.1
    latex: F^{z1}
  # For these priors we take the philosophy that rba0^2 (a0 + a1/rbao) <~ <rbao^2 xi> ~ 50
  # i.e. a0 <~ 5e-3, a2 <~ 5e-1, and we enforce a 10x wide Gaussian prior on this estimation
  M0_z1:
    prior:
      dist: norm
      loc: 0.
      scale: 5e-2
    ref:
      dist: norm
      loc: 0.00405758
      scale: 0.001
    latex: M_0^{z1}
  M1_z1:
    prior:
      dist: norm
      loc: 0.
      scale: 5.
    ref:
      dist: norm
      loc: -0.30657935
      scale: 0.1
    latex: M_1^{z1}
  M2_z1:
    value: 0.
  Q0_z1:
    prior:
      dist: norm
      loc: 0.
      scale: 5e-2
    ref:
      dist: norm
      loc: -0.00699841
      scale: 0.001
    latex: Q_0^{z1}
  Q1_z1:
    prior:
      dist: norm
      loc: 0.
      scale: 5.
    ref:
      dist: norm
      loc: 0.93152832
      scale: 0.1
    latex: Q_1^{z1}
  Q2_z1:
    value: 0.
  # NGCz3

  # Extra variables needed for the lensing
  bn_NGCz3:
    value: 0.0
  alpha_a_NGCz3:
    value: 0.0
    latex: \alpha_{a}^{N3}
  alpha_x_NGCz3:
    prior:
      dist:  norm
      loc:   0.0
      scale: 50.
    ref:
      dist:  norm
      loc:   0.0
      scale: 5.0
    latex: \alpha_{\times}^{N3}
  SN_NGCz3:
    value: 0.0
    latex: SN^{N3}
  smag_NGCz3:
    prior:
      dist: norm
      loc:   1.05
      scale: 0.11
    ref:
      dist:  norm
      loc:   1.05
      scale: 0.11
    latex: s_{\mu}^{N3}
    
  bn_SGCz3:
    value: 0.0
  alpha_a_SGCz3:
    value: 0.0
    latex: \alpha_{a}^{S3}
  alpha_x_SGCz3:
    prior:
      dist:  norm
      loc:   0.0
      scale: 50.
    ref:
      dist:  norm
      loc:   0.0
      scale: 5.0
    latex: \alpha_{\times}^{S3}
  SN_SGCz3:
    value: 0.0
    latex: SN^{N3}
  smag_SGCz3:
    prior:
      dist: norm
      loc:   1.05
      scale: 0.11
    ref:
      dist:  norm
      loc:   1.05
      scale: 0.11
    latex: s_{\mu}^{S3}

  bn_NGCz1:
    value: 0.0
  alpha_a_NGCz1:
    value: 0.0
    latex: \alpha_{a}^{N1}
  alpha_x_NGCz1:
    prior:
      dist:  norm
      loc:   0.0
      scale: 50.
    ref:
      dist:  norm
      loc:   0.0
      scale: 5.0
    latex: \alpha_{\times}^{N1}
  SN_NGCz1:
    value: 0.0
    latex: SN^{N1}
  smag_NGCz1:
    prior:
      dist: norm
      loc:   0.77
      scale: 0.02
    ref:
      dist:  norm
      loc:   0.77
      scale: 0.02
    latex: s_{\mu}^{N1}
    
  bn_SGCz1:
    value: 0.0
  alpha_a_SGCz1:
    value: 0.0
    latex: \alpha_{a}^{S1}
  alpha_x_SGCz1:
    prior:
      dist:  norm
      loc:   0.0
      scale: 50.
    ref:
      dist:  norm
      loc:   0.0
      scale: 5.0
    latex: \alpha_{\times}^{S1}
  SN_SGCz1:
    value: 0.0
    latex: SN^{N1}
  smag_SGCz1:
    prior:
      dist: norm
      loc:   0.77
      scale: 0.02
    ref:
      dist:  norm
      loc:   0.77
      scale: 0.02
    latex: s_{\mu}^{S1}

sampler:
  mcmc:
    #covmat: chains/bossz3_joint.covini
    learn_proposal: True
    learn_proposal_Rminus1_max: 30.
    output_every: 60s
    measure_speeds: True
    max_tries: 500
    oversample_power: 0.4
    proposal_scale: 1.5
    Rminus1_stop: 0.01
output: chains/boss_rxk_emu
timing: True
stop_on_error: True
